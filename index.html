<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Trường Cao đẳng FPT Polytechnic</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="stylesheet" href="plugins/bootstrap/bootstrap.min.css">
  <link rel="stylesheet" href="plugins/slick/slick.css">
  <link rel="stylesheet" href="plugins/themify-icons/themify-icons.css">
  <link rel="stylesheet" href="plugins/animate/animate.css">
  <link rel="stylesheet" href="plugins/aos/aos.css">
  <link rel="stylesheet" href="plugins/venobox/venobox.css">
  <link rel="stylesheet" href="css/custom.css">
  <link href="css/style.css" rel="stylesheet">
  <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon">
  <link rel="icon" href="images/favicon.png" type="image/x-icon">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular-route.js"></script>
  <script data-require="angular-ui-bootstrap@0.3.0" data-semver="0.3.0" src="js/pagination.js"></script>
  <!-- Main Stylesheet -->
  <link href="css/style.css" rel="stylesheet">
  <link rel="stylesheet" href="css/style-login.css"/>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
</head>
<body ng-app="myapp" ng-controller="ctrl" class="container-body">
  <header style="background-color: #1a1a37;" class="fixed-top header">
    <!-- top header -->
    <div class="top-header py-2 bg-white">
      <div class="container">
        <div class="row no-gutters">
          <div class="col-lg-7 text-center text-lg-left">
            <ul class="list-inline d-inline">
			  <img src="images/vietnamflag.png" width="20">&nbsp;<img src="images/usaflag.png" width="20">
              <li class="list-inline-item mx-0"><a class="d-inline-block p-2 text-color"><i class="fa fa-phone-square" aria-hidden="true"></i> Điện thoại: (024) 7300 1955</a></li>
              <li class="list-inline-item mx-0"><a class="d-inline-block p-2 text-color"><i class="fa fa-envelope" aria-hidden="true"></i> caodang@fpt.edu.vn</a></li>
            </ul>
          </div>
          <div class="col-lg-5 text-center text-lg-right">
            <ul class="list-inline">
              <li ng-if="!userName" class="list-inline-item"><a class="text-uppercase text-color p-sm-2 py-2 px-0 d-inline-block" href="#!login" data-toggle="modal" data-target="#loginModal"><i class="fa fa-sign-in" aria-hidden="true"></i> Đăng nhập</a></li>
              <li ng-if="!userName" class="list-inline-item"><a class="text-uppercase text-color p-sm-2 py-2 px-0 d-inline-block" href="#!register" data-toggle="modal" data-target="#signupModal"><i class="fa fa-pencil-square-o" aria-hidden="true"></i> Đăng kí</a></li>
              <li ng-if="userName" class="list-inline-item dropdown-toggle" data-toggle="dropdown"><i class="fa fa-user" aria-hidden="true"></i> {{userName}}</li>
			  <li ng-if="userName" class="list-inline-item">
                <a href="#!update-account" class="dropdown-item"><i class="fa fa-circle" aria-hidden="true"></i> Quản lý tài khoản</a>
              </li>
              <li ng-if="userName" class="list-inline-item">
                <a href="#!change-pass" class="dropdown-item"><i class="fa fa-circle" aria-hidden="true"></i> Đổi mật khẩu</a>
              </li>
              <li ng-if="userName" class="list-inline-item">
                <a class="dropdown-item" ng-click="clearSession()"><i class="fa fa-circle" aria-hidden="true"></i> Đăng xuất</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- navbar -->
    <div class="navigation w-100" >
      <div class="container">
        <nav class="navbar navbar-expand-lg navbar-dark p-0">
          <a class="navbar-brand" href="#/!"><img src="images/logo.png" alt="logo"></a>
          <button class="navbar-toggler rounded-0" type="button" data-toggle="collapse" data-target="#navigation"
                  aria-controls="navigation" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navigation">
            <ul class="navbar-nav ml-auto text-center">
              <li class="nav-item">
                <a class="nav-link" href="#/!"><i class="fa fa-home" aria-hidden="true"></i> Trang chủ</a>
              </li>
              <li class="nav-item @@courses">
                <a class="nav-link" href="#!about"><i class="fa fa-pencil-square" aria-hidden="true"></i> Giới thiệu</a>
              </li>
              <li class="nav-item @@contact">
                <a class="nav-link" href="#!contact"><i class="fa fa-envelope" aria-hidden="true"></i> Liên hệ</a>
              </li>
            </ul>
          </div>
        </nav>
      </div>
    </div>
  </header>
  <div ng-view></div>
    <!-- Footer -->
        <footer style="border-top: 10px solid #f7941d;" class="bg-dark text-center text-light text-lg-start mt-5">
            <!-- Grid container -->
            <div class="container-fluid p-4">
                <!--Grid row-->
                <div class="row">
                    <!--Grid column-->
                    <div class="col-lg-5 col-md-12 mb-4 mb-md-0">
                        <img src="images/logo.png" class="img-fluid">
                            <p style="font-size: 20px; color: #f7941d;">THÔNG TIN LIÊN HỆ</p>
							<p>Điện thoại: 032837121</p>
							<p>Email: dangnhpc01718@fpt.edu.vn</p>
                    </div>
                    <!--Grid column-->

                    <!--Grid column-->
                    <div class="col-lg-3 col-md-6 mb-4 mb-md-0 text-sm-left">
                        <h5 style="color: #f7941d;" class="text-uppercase">HỆ THỐNG CƠ SỞ ĐÀO TẠO</h5>

                        <ul class="list-unstyled mb-0">
                            <li>
                               <u>Cơ sở Hà Nội</u>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-map-marker" aria-hidden="true"></i> Tòa nhà FPT Polytechnic, Phố Trịnh Văn Bô, Nam Từ Liêm, Hà Nội</p>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-phone-square" aria-hidden="true"></i>032 257 2576 </p>
                            </li>
                            <li>
                               <u>Cơ sở Đà Nẵng</u>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-map-marker" aria-hidden="true"></i> Số 137 Nguyễn Thị Thập, Phường Hòa Minh, Quận Liên Chiểu, TP. Đà Nẵng</p>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-phone-square" aria-hidden="true"></i> 032 963 9874</p>
                            </li>
                            <li>
                               <u>Cơ sở Cần Thơ</u>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-map-marker" aria-hidden="true"></i> Số 288, Nguyễn Văn Linh, phường An Khánh, quận Ninh Kiều, Tp. Cần Thơ</p>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-phone-square" aria-hidden="true"></i> 092 159 3697</p>
                            </li>
                        </ul>
                    </div>
                    <!--Grid column-->

                    <!--Grid column-->
                    <div class="col-lg-3 col-md-6 mb-4 mb-md-0 text-sm-left">
						<div class="mt-4"></div>
                        <ul class="list-unstyled">
                            <li>
                               <u>Cơ sở Hồ Chí Minh</u>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-map-marker" aria-hidden="true"></i> Văn phòng Tuyển sinh: 778/B1 Nguyễn Kiệm, P.4, Q. Phú Nhuận, TP. Hồ Chí Minh</p>
                            </li>
							<li>
                               <u>Cơ sở Tây Nguyên</u>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-map-marker" aria-hidden="true"></i> Tổ dân phố 8, phường Tân An, TP. Buôn Mê Thuột, Đắk Lắk</p>
							   <p style="font-size: 13px;"><i style="color: #f7941d;" class="fa fa-phone-square" aria-hidden="true"></i> (0999) 111 5678</p>
                            </li>
                        </ul>
                    </div>
                    <!--Grid column-->
                </div>
                <!--Grid row-->
            </div>
            <!-- Grid container -->
		
            <!-- Copyright -->
            <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2);">
                Copyright © 2021 by
                <a class="text-light" href="#">FPT Polytechnic</a>
            </div>
            <!-- Copyright -->
        </footer>
        <!-- Footer -->
  <script>
    var app = angular.module("myapp", ["ngRoute", "ui.bootstrap"]);
    app.config(function($routeProvider) {
      $routeProvider
        .when("/", {
          templateUrl : "home.html"
        })
        .when("/about", {
          templateUrl : "about.html"
        })
        .when("/subjects", {
          templateUrl : "subjects.html"
        })
        .when("/contact", {
          templateUrl : "contact.html"
        })
        .when("/login", {
          templateUrl : "login.html"
        })
        .when('/forgot-password', {
          templateUrl: 'forgot-password.html'
        })
        .when("/register", {
          templateUrl : "register.html"
        })
        .when("/update-account", {
          templateUrl : "update-account.html",
          controller: 'AccountController'
        })
        .when("/change-pass", {
          templateUrl : "change-pass.html"
        })
        .when('/subject-single/:param1', {
          templateUrl: 'subject-single.html',
          controller: 'RoutingController'
        })
    });
    app.controller("ctrl",function($scope,$http, $location){
      $scope.subjects=[];
      $scope.students=[];
      $scope.limit = 9;
      $scope.loginSuccess = false;
      $scope.accountExist = false;
      $scope.findPassword = null;
      $scope.userID = null;
      $scope.userName = null;
      $scope.user = null;
      $scope.loadMore = function() {
        var increamented = $scope.limit + 9;
        $scope.limit = increamented > $scope.subjects.length ? $scope.subjects.length : increamented;
      };
      $http.get('db/data.json')
              .then(function(response){
                $scope.subjects=response.data.subjects;
                $scope.students=response.data.students;
              },function (response){
                console.log("lổi");
              });
      //Đăng nhập
      $scope.login = function (){
        var username = $('input[name = Username]').val();
        var password = $('input[name = Password]').val();
        for (var i=0; i<$scope.students.length; i++){
          if(username == $scope.students[i].username && password == $scope.students[i].password){
            $scope.loginSuccess = true;
            $scope.userID = $scope.students[i].id;
          }
        }
        if($scope.loginSuccess == true){
          sessionStorage.setItem("username", username);
          sessionStorage.setItem("userid", $scope.userID);
          alert("Chúc mừng bạn đã đăng nhập thành công !");
          // location.reload();
          $location.url('/');
        }else{
          alert("Đăng nhập thất bại !");
        }
      }
      $scope.userName = sessionStorage.getItem("username");
      $scope.userID = sessionStorage.getItem("userid");
      //Quên mật khẩu
      $scope.forgotPassword = function (){
        var username = $('input[name = Username]').val();
        var email = $('input[name = Email]').val();
        for (var i=0; i<$scope.students.length; i++){
          if(username == $scope.students[i].username && email == $scope.students[i].email){
            $scope.accountExist = true;
            $scope.findPassword= $scope.students[i].password;
          }
        }
        if($scope.accountExist == true){
          alert("Mật khẩu của bạn là: "+$scope.findPassword);
        }else{
          alert("Tên đăng nhập hoặc email không đúng !");
        }
      }
      $scope.clearSession = function (){
        sessionStorage.clear();
        location.reload();
      }
      //Đổi mật khẩu
      $scope.changePass = function (){
        var newpassword = $('input[name = newpassword]').val();
        $scope.fullname = null;
        $scope.username = null;
        $scope.password = null;
        $scope.email = null;
        $scope.birthday = null;
        $scope.gender = null;
        $scope.marks = 0;
        $scope.schoolfee = 0;
        for (var i=0; i<$scope.students.length; i++){
          if($scope.userID == $scope.students[i].id){
            $scope.fullname = $scope.students[i].fullname;
            $scope.username = $scope.students[i].username;
            $scope.password = newpassword;
            $scope.email = $scope.students[i].email;
            $scope.birthday = $scope.students[i].birthday;
            $scope.gender = $scope.students[i].gender;
            $scope.marks = $scope.students[i].marks;
            $scope.schoolfee = $scope.students[i].schoolfee;
          }
        }
        var data = {
          fullname: $scope.fullname,
          username:$scope.username,
          password:$scope.password,
          email: $scope.email,
          birthday: $scope.birthday,
          gender: $scope.gender,
          marks: $scope.marks,
          schoolfee: $scope.schoolfee
        };
        $http.put('http://localhost:3000/students/'+$scope.userID, JSON.stringify(data))
            .then(function (response) {
                if (response)
                    alert("Đổi mật khẩu thành công!");
                    location.reload();
                },
                function (response) {
                  alert("Đổi mật khẩu thất bại!");
                });
      }
    });
    app.controller("RoutingController", function ($scope, $routeParams, $location, $http, $timeout) {
      $scope.counter = 600;
      $scope.onTimeout = function () {
        if ($scope.counter > 0) $scope.counter--;
        mytimeout = $timeout($scope.onTimeout, 1000);
      }
      var mytimeout = $timeout($scope.onTimeout, 1000);
      var url = $location.path().split('/');
      $scope.bannerName = '';
      $scope.subject=[];
      $scope.quizs=[];
      $scope.questions=[];
      $scope.firstParameter = url[2];
      $scope.viewby = 1;
      $scope.currentPage = 1;
      $scope.correct = false;
      $scope.checked = false;
      $scope.marks = 0;
      if($scope.questions != []){
        $scope.questions=[];
      }
      if($scope.firstParameter){
        $http({
          method: 'GET',
          url: 'http://localhost:3000/subjects/'+$scope.firstParameter,
        }).then(function(response) {
          $scope.subject = response.data;
        });
        $http.get('db/Quizs/'+$scope.firstParameter+'.json')
            .then(function(response){
              $scope.quizs=response.data[$scope.firstParameter];
              $scope.curPage = 1,
              $scope.itemsPerPage = 1,
              $scope.maxSize = 10;
              for (var i=0; i<10; i++){
                var randomItem = $scope.quizs[Math.floor(Math.random()*$scope.quizs.length)];
                $scope.questions.push(randomItem);
              }
              $scope.numOfPages = function () {
                return Math.ceil($scope.questions.length / $scope.itemsPerPage);
              };
              $scope.$watch('curPage + numPerPage', function() {
                var begin = (($scope.curPage - 1) * $scope.itemsPerPage),
                        end = begin + $scope.itemsPerPage;
                $scope.filteredItems =  $scope.questions.slice(begin, end);
                $scope.chooseAnswer = function (answerId, curPage, itemId){
                  if($scope.questions[curPage-1]){
                    $scope.questions[curPage-1]['checked'] = true;
                    if(answerId == $scope.questions[curPage-1].AnswerId){
                      $scope.questions[curPage-1]['correct'] = true;
                      $scope.marks = $scope.marks + $scope.questions[curPage-1]['Marks'];
                      for (var i = 0; i<$scope.questions[curPage-1].Answers.length;i++){
                        if(answerId == $scope.questions[curPage-1].Answers[i].Id){
                          $scope.questions[curPage-1].Answers[i]['result'] = true;
                          document.querySelector("#checked"+answerId).parentElement.classList.add('color-correct');
                        }
                      }
                    }
                    if(answerId != $scope.questions[curPage-1].AnswerId){
                      for (var i = 0; i<$scope.questions[curPage-1].Answers.length;i++){
                        if(answerId == $scope.questions[curPage-1].Answers[i].Id){
                          $scope.questions[curPage-1].Answers[i]['result'] = false;
                          document.querySelector("#checked"+answerId).parentElement.classList.add('color-faild');
                        }
                        if($scope.questions[curPage-1].AnswerId == $scope.questions[curPage-1].Answers[i].Id){
                          $scope.questions[curPage-1].Answers[i]['result'] = true;
                          document.querySelector("#checked"+answerId).parentElement.classList.add('color-correct');
                        }
                      }
                    }
                  }
                }
              });
            },function (response){
              console.log("lổi");
            });

      }
    });
    app.filter('secondsToDateTime', [function() {
      return function(seconds) {
        return new Date(1970, 0, 1).setSeconds(seconds);
      };
    }]);
    //Đăng ký thành viên
    app.controller('addStudent', function ($scope, $http) {
      $scope.fullname = null;
      $scope.username = null;
      $scope.password = null;
      $scope.email = null;
      $scope.birthday = null;
      $scope.gender = null;
      $scope.marks = 0;
      $scope.schoolfee = 0;
      $scope.register = function (fullname, username, password, email, birthday, gender, marks, schoolfee) {
        var data = {
          fullname: fullname,
          username:username,
          password:password,
          email: email,
          birthday: birthday,
          gender: gender,
          marks: marks,
          schoolfee: schoolfee
        };
        $http.post('http://localhost:3000/students', JSON.stringify(data))
          .then(function (response) {
              if (response.data)
                alert("Đăng ký thành công!");
            },
            function (response) {
              alert("Đăng ký thất bại!");

            });
      };
    });
    app.controller('AccountController', function ($scope, $http) {
      $scope.username = null;
      $scope.fullname = null;
      $scope.email = null;
      $scope.password = null;
      $scope.birthday = null;
      $scope.gender = null;
      $http.get('http://localhost:3000/students/'+$scope.userID)
        .then(function(response){
          $scope.username = response.data.username;
          $scope.fullname = response.data.fullname;
          $scope.email = response.data.email;
          $scope.password = response.data.password;
          $scope.birthday = response.data.birthday;
          $scope.gender = response.data.gender;
          $scope.schoolfee = response.data.birthday;
          $scope.marks = response.data.marks;
          $scope.update = function (){
            var username = $scope.username;
            var fullname = $('input[name = fullname]').val();
            var email = $('input[name = email]').val();
            var password = $scope.password;
            var birthday = $('input[name = birthday]').val();
            var gender = $('input[name = gender2]').val();
            var schoolfee = $scope.schoolfee;
            var marks = $scope.marks;
            var data = {
              fullname: fullname,
              username:username,
              password:password,
              email: email,
              birthday: birthday,
              gender: gender,
              marks: marks,
              schoolfee: schoolfee
            };
            $http.put('http://localhost:3000/students/'+$scope.userID, JSON.stringify(data))
              .then(function (response) {
                  if (response)
                    alert("Cập nhật thành công!");
                  location.reload();
                },
                function (response) {
                  alert("Cập nhật thất bại!");
                });
          }
        },function (response){
          console.log("lổi");
        });

    });
  </script>
  <!-- jQuery -->
  <script src="plugins/jQuery/jquery.min.js"></script>
  <!-- Bootstrap JS -->
  <script src="plugins/bootstrap/bootstrap.min.js"></script>
  <!-- slick slider -->
  <script src="plugins/slick/slick.min.js"></script>
  <!-- aos -->
  <script src="plugins/aos/aos.js"></script>
  <!-- venobox popup -->
  <script src="plugins/venobox/venobox.min.js"></script>
  <!-- filter -->
  <script src="plugins/filterizr/jquery.filterizr.min.js"></script>

  <!-- Main Script -->
  <script src="js/script.js"></script>

</body>
</html>
